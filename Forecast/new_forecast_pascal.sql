SELECT 
    [ITEMNO],
    [DATE],
    [REASONCODE],
    [DateColumn],
    [Value]
FROM 
    (SELECT 
        [ITEMNO],
        [DATE],
        [REASONCODE],
        [2023_01_01_00_00_00],
        [2023_02_01_00_00_00],
        [2023_03_01_00_00_00],
        [2023_04_01_00_00_00],
        [2023_05_01_00_00_00],
        [2023_06_01_00_00_00],
        [2023_07_01_00_00_00],
        [2023_08_01_00_00_00],
        [2023_09_01_00_00_00],
        [2023_10_01_00_00_00],
        [2023_11_01_00_00_00],
        [2023_12_01_00_00_00],
        [2024_01_01_00_00_00],
        [2024_02_01_00_00_00],
        [2024_03_01_00_00_00],
        [2024_04_01_00_00_00],
        [2024_05_01_00_00_00],
        [2024_06_01_00_00_00],
        [2024_07_01_00_00_00],
        [2024_08_01_00_00_00],
        [2024_09_01_00_00_00],
        [2024_10_01_00_00_00],
        [2024_11_01_00_00_00],
        [2024_12_01_00_00_00],
        [2025_01_01_00_00_00],
        [2025_02_01_00_00_00],
        [2025_03_01_00_00_00],
        [2025_04_01_00_00_00],
        [2025_05_01_00_00_00],
        [2025_06_01_00_00_00],
        [2025_07_01_00_00_00],
        [2025_08_01_00_00_00],
        [2025_09_01_00_00_00],
        [2025_10_01_00_00_00],
        [2025_11_01_00_00_00],
        [2025_12_01_00_00_00],
        [LOAD_TIMESTAMP]
    FROM [L0].[L0_MI_OPERATIONAL_FORECAST_INPUT]
    ) AS SourceTable
UNPIVOT
    ([Value] FOR [DateColumn] IN 
        ([2023_01_01_00_00_00],
        [2023_02_01_00_00_00],
        [2023_03_01_00_00_00],
        [2023_04_01_00_00_00],
        [2023_05_01_00_00_00],
        [2023_06_01_00_00_00],
        [2023_07_01_00_00_00],
        [2023_08_01_00_00_00],
        [2023_09_01_00_00_00],
        [2023_10_01_00_00_00],
        [2023_11_01_00_00_00],
        [2023_12_01_00_00_00],
        [2024_01_01_00_00_00],
        [2024_02_01_00_00_00],
        [2024_03_01_00_00_00],
        [2024_04_01_00_00_00],
        [2024_05_01_00_00_00],
        [2024_06_01_00_00_00],
        [2024_07_01_00_00_00],
        [2024_08_01_00_00_00],
        [2024_09_01_00_00_00],
        [2024_10_01_00_00_00],
        [2024_11_01_00_00_00],
        [2024_12_01_00_00_00],
        [2025_01_01_00_00_00],
        [2025_02_01_00_00_00],
        [2025_03_01_00_00_00],
        [2025_04_01_00_00_00],
        [2025_05_01_00_00_00],
        [2025_06_01_00_00_00],
        [2025_07_01_00_00_00],
        [2025_08_01_00_00_00],
        [2025_09_01_00_00_00],
        [2025_10_01_00_00_00],
        [2025_11_01_00_00_00],
        [2025_12_01_00_00_00])
    ) AS UnpivotedTable;







ALTER VIEW PL.PL_V_OPERATIONAL_FORECAST
AS

SELECT
		[ItemId] = it.[ItemId],
		ItemNo = fc.[ITEMNO],
        AdjustmentDate = [DATE],
        Reason = [REASONCODE],
        [Jan-23] = [2023_01_01_00_00_00],
        [Feb-23] = [2023_02_01_00_00_00],
        [Mar-23] = [2023_03_01_00_00_00],
		[Apr-23] = [2023_04_01_00_00_00],
		[May-23] = [2023_05_01_00_00_00],
		[Jun-23] = [2023_06_01_00_00_00],
		[Jul-23] = [2023_07_01_00_00_00],
		[Aug-23] = [2023_08_01_00_00_00],
		[Sep-23] = [2023_09_01_00_00_00],
		[Oct-23] = [2023_10_01_00_00_00],
		[Nov-23] = [2023_11_01_00_00_00],
		[Dec-23] = [2023_12_01_00_00_00],
        [Jan-24] = [2024_01_01_00_00_00],
        [Feb-24] = [2024_02_01_00_00_00],
        [Mar-24] = [2024_03_01_00_00_00],
        [Apr-24] = [2024_04_01_00_00_00],
        [May-24] = [2024_05_01_00_00_00],
        [Jun-24] = [2024_06_01_00_00_00],
        [Jul-24] = [2024_07_01_00_00_00],
        [Aug-24] = [2024_08_01_00_00_00],
        [Sep-24] = [2024_09_01_00_00_00],
        [Oct-24] = [2024_10_01_00_00_00],
        [Nov-24] = [2024_11_01_00_00_00],
        [Dec-24] = [2024_12_01_00_00_00],
        [Jan-25] = [2025_01_01_00_00_00],
        [Feb-25] = [2025_02_01_00_00_00],
        [Mar-25] = [2025_03_01_00_00_00],
        [Apr-25] = [2025_04_01_00_00_00],
        [May-25] = [2025_05_01_00_00_00],
        [Jun-25] = [2025_06_01_00_00_00],
        [Jul-25] = [2025_07_01_00_00_00],
        [Aug-25] = [2025_08_01_00_00_00],
        [Sep-25] = [2025_09_01_00_00_00],
        [Oct-25] = [2025_10_01_00_00_00],
        [Nov-25] = [2025_11_01_00_00_00],
        [Dec-25] = [2025_12_01_00_00_00]
FROM [L0].[L0_MI_OPERATIONAL_FORECAST_INPUT] fc
LEFT JOIN PL.PL_V_ITEM it on fc.itemno = it.itemno